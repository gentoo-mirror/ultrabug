From 22af0a08b3fd7c9c29107095370f634d90f8afad Mon Sep 17 00:00:00 2001
Message-Id: <22af0a08b3fd7c9c29107095370f634d90f8afad.1574845916.git.asias@scylladb.com>
From: Asias He <asias@scylladb.com>
Date: Wed, 27 Nov 2019 16:53:27 +0800
Subject: [PATCH scylla v1] repair: Add a timer for repair reader
To: scylladb-dev@googlegroups.com

---
 repair/row_level.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/repair/row_level.cc b/repair/row_level.cc
index ea0f7f2524..ec92c169b0 100644
--- a/repair/row_level.cc
+++ b/repair/row_level.cc
@@ -339,7 +339,7 @@ using is_local_reader = bool_class<class is_local_reader_tag>;
 public:
     future<mutation_fragment_opt>
     read_mutation_fragment() {
-        return _reader(db::no_timeout);
+        return _reader(db::timeout_clock::now() + std::chrono::seconds(60 * 5));
     }
 
     lw_shared_ptr<const decorated_key_with_hash>& get_current_dk() {
-- 
2.23.0

